# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Основные компоненты

### Базовый код 

- ```Api```: Этот класс предназначен для взаимодействия с API с помощью HTTP-запросов. Он содержит основные функции для работы с API, такие как отправка запросов и обработка ответов. В нем есть свойства: ```baseUrl``` (базовый URL для всех запросов API), ```options```  (параметры запроса, которые можно настроить по умолчанию) и методы: ```get(uri: string)```  (отправляет GET запрос на указанный url и возвращает Promise с обработанными данными ответа), ```post(uri: string, data: object, method: ApiPostMethods = 'POST')``` (отправляет POST, PUT или DELETE запросы на указанный url с указанными данными и возвращает Promise с обработанными данными ответа), а также защищенный метод  ```handleResponse(response: Response)```  (обрабатывает ответ API, возвращая JSON данные при успешном запросе или отклоняя Promise при ошибке).

- ```Component```: Это абстрактный базовый класс для создания пользовательских компонентов, которые работают с DOM-элементами. Основные методы класса: ```toggleClass(element: HTMLElement, className: string, force?: boolean)``` (переключает заданный класс для элемента), ```setText(element: HTMLElement, value: unknown)``` (устанавливает текстовое содержимое элемента), ```setDisabled(element: HTMLElement, state: boolean)``` - (изменяет статус блокировки элемента),  ```setHidden(element: HTMLElement)``` (скрывает элемент),  ```setVisible(element: HTMLElement)``` (показывает элемент),  ```setImage(element: HTMLImageElement, src: string, alt?: string)``` (устанавливает изображение и альтернативный текст для элемента) ```render(data?: Partial<T>): HTMLElement``` (метод для рендера компонента, который возвращает корневой DOM-элемент).

- ```EventEmitter```: Этот класс предоставляет методы для управления событиями в приложении, такие как установка и удаление обработчиков, инициирование событий и прослушивание всех событий. В нем есть свойство ```_events``` (карта для хранения событий и соответствующих подписчиков) и методы ```on<T extends object>(eventName: EventName, callback: (event: T) => void)```  (устанавливает обработчик для события),  ```off(eventName: EventName, callback: Subscriber)``` (снимает обработчик для события), ```emit<T extends object>(eventName: string, data?: T)``` (инициирует событие с переданными данными), ```onAll(callback: (event: EmitterEvent) => void)``` (устанавливает обработчик на все события), ```offAll()``` (сбрасывает все обработчики событий) ```trigger<T extends object>(eventName: string, context?: Partial<T>)``` (возвращает коллбек, который вызывает emit для события с контекстом).

- ```Sample```: Это абстрактный класс для создания моделей данных с поддержкой событий. Он предназначен для управления данными и уведомления других компонентов об изменениях в моделях.

## Элементы и функции в интерфейсах.

### Компоненты представления

1. ```Modal```: Этот класс предназначен для работы с модальными окнами в приложении. Он содержит методы для открытия, закрытия и обновления содержимого модального окна, а также обработки событий. Включает в себя свойства ```_content``` и ```closeButton```, которые отвечают за содержимое модального окна и кнопку закрытия соответственно. Методы класса включают в себя:
- ```openModal()``` (открытие модального окна);
- ```closeModal()``` (закрытие модального окна при клике на оверлей или кнопку закрытия);
- ```render(changeButton)``` (отрисовка содержимого модального окна в зависимости от контекста - в карточке или в корзине).

2. ```Basket```: Этот класс отвечает за управление корзиной покупок, включая добавление и удаление элементов, а также отображение их в элементе списка корзины на веб-странице. Содержит свойства ```_list``` (элемент списка корзины (HTMLElement), в котором показываются товары), ```_total``` (элемент, в котором отображается общая стоимость товаров в корзине) и ```_button``` (кнопка для действий с корзиной (HTMLButtonElement)). Методы класса включают в себя:
  - ```set items(items: HTMLElement[])``` (устанавливает элементы в корзину. Если элементы отсутствуют, выводится сообщение о пустой корзине. В противном случае, заменяет содержимое списка корзины на переданные элементы).

3. ```Card```: Этот класс управляет карточками в приложении, настраивает их атрибуты, такие как идентификатор, заголовок, цена, изображение, описание и категория. Предоставляет методы для взаимодействия с карточками и их элементами. Обязательные свойства класса: ```_id```, ```_title```, ```_price```. Необязательные: ```_description```, ```_image```, ```_category```, ```_button``` и ```_categoryColor```  (Карта для соответствия категорий классам стилей). В классе также есть сеттеры и геттеры для установки значений свойств.

4. ```Order```: Это класс для работы с формой заказа. Он хранит данные, введенные пользователем во время оформления заказа. Содержит четыре обязательных элемента.

5. ```Page```: Этот класс управляет страницей в приложении, включая настройку списка продуктов, блокировку и разблокировку страницы, а также обработку событий, связанных с корзиной. Содержит свойства ```_cardList``` (элемент списка карточек продуктов (HTMLElement), в котором отображаются товары на странице), ```_basket``` (элемент корзины (HTMLElement) в header), ```_basket_counter``` (элемент, показывающий количество товаров в корзине) и ```_pageWrapper``` (элемент обертки страницы (HTMLElement), который может быть заблокирован). Методы класса включают в себя:
  - ```set productList(items: HTMLElement[])``` (устанавливает список продуктов, заменяя содержимое списка карточек на переданные элементы):
  - ```set locked(value: boolean)``` (устанавливает состояние блокировки страницы). 

### Компоненты модели данных

1. ```LarekApi```: Этот класс предназначен для взаимодействия с API приложения и получения информации о товарах и списках товаров. Он учитывает расположение CDN для правильного формирования путей к изображениям товаров, обеспечивая корректное взаимодействие с внешними сервисами и источниками данных. Включает свойство ```cdn``` только для чтения и следующие методы:
  - ```getProductItem(id: string): Promise<ICard>``` (получает данные о товаре по его идентификатору (id) и возвращает объект с информацией о товаре (ICard), включая URL изображения, сформированный на основе CDN и пути к изображению);
  - ```getProductList(): Promise<ICard[]>``` (получает список товаров из API и возвращает массив объектов с данными о товарах (ICard[]), включая полные URL изображений товаров, которые построенны на CDN и путях к изображениям).

2. ```AppData```: Это основной класс для работы с данными в приложении. Содержит свойства и методы:
  - ```items``` - массив товаров (ICard[]), в котором находятся все товары; 
  - ```catalog``` - массив каталога товаров (ICard[]); 
  - ```basket``` - массив корзины товаров (ICard[]); 
  - ```preview``` - предварительный просмотр идентификатора выбранного товара (null или строка);
  - ```order``` - объект заказа (IOrder) с информацией о текущем заказе: email, телефон, адрес, способ оплаты, общая стоимость и список товаров
  - ```setItems(items: ICard[])``` - устанавливает список товаров (items) и обновляет свойство items;
  - ```setPreview(item: ICard)``` - устанавливает предварительный просмотр (item) и обновляет свойство preview;
  - ```addToBasket(item: ICard)``` - добавляет товар в корзину, если его там ещё нет;
  - ```removeFromBasket(item: ICard)``` - удаляет товар из корзины.
